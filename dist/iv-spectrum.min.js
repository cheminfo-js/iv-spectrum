!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).IVSpectrum={})}(this,(function(e){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?n(Object(i),!0).forEach((function(n){t(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{rescale:n=!1,uniqueX:r=!1,xColumn:i=0,yColumn:a=1,keepInfo:l=!1,maxNumberColumns:o=Number.MAX_SAFE_INTEGER,minNumberColumns:s=2}=t;o=Math.max(o,i+1,a+1),s=Math.max(i+1,a+1,s);let c=e.split(/[\r\n]+/),f=Number.MIN_VALUE,p={x:[],y:[]},u=[];for(let e=0;e<c.length;e++){let t=c[e].trim();if(t.match(/[0-9]+/)&&t.match(/^[0-9eE,;. \t+-]+$/)){let e=t.split(/,[; \t]+|[; \t]+/);if(1===e.length&&(e=t.split(/[,; \t]+/)),e&&e.length>=s&&e.length<=o){let t=parseFloat(e[i].replace(",",".")),n=parseFloat(e[a].replace(",","."));n>f&&(f=n),p.x.push(t),p.y.push(n)}}else t&&u.push({position:p.x.length,value:t})}if(r&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{x:t,y:n}=e;if(t.length<2)return;if(t.length!==n.length)throw new Error("The X and Y arrays mush have the same length");let r=t[0],i=0;for(let e=1;e<t.length;e++)r!==t[e]&&(i++,r=t[e],t[i]=t[e],e!==i&&(n[i]=0)),e!==i&&(n[i]+=n[e]);t.length=i+1,n.length=i+1}(p),n)for(let e=0;e<p.y.length;e++)p.y[e]/=f;return l?{info:u,data:p}:p}function a(e){return{x:e[0],y:e[1]}}function l(e){var t=[],n=[];for(const r of e)t.push(r[0]),n.push(r[1]);return{x:t,y:n}}function o(e){var t=[],n=[];for(const r of e)t.push(r.x),n.push(r.y);return{x:t,y:n}}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{inputFormat:n,outputFormat:r="xxyyObject"}=t;if(n===r)return e;let i;switch(n){case"xxyyArray":i=a(e);break;case"xyxyArray":i=l(e);break;case"xxyyObject":i=e;break;case"xyxyObject":i=o(e);break;default:i=function(e){if(Array.isArray(e))return 0===e.length?{x:[],y:[]}:Array.isArray(e[0])?2===e.length?a(e):l(e):o(e);if(Array.isArray(e.x)&&Array.isArray(e.x))return e;throw new TypeError("unknown data format")}(e)}switch(r){case"xxyyArray":return function(e){let{x:t,y:n}=e;return[t,n]}(i);case"xyxyArray":return function(e){let{x:t,y:n}=e;for(var r=[],i=0;i<t.length;i++)r.push([t[i],n[i]]);return r}(i);case"xxyyObject":return i;case"xyxyObject":return function(e){let{x:t,y:n}=e;for(var r=[],i=0;i<t.length;i++)r.push({x:t[i],y:n[i]});return r}(i);default:throw new TypeError("unknown output format ".concat(r))}}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{title:n="",owner:r="",origin:i="",type:a="",xUnit:l="",yUnit:o="",info:s={}}=t;let c=Number.MAX_VALUE,f=Number.MIN_VALUE,p=Number.MAX_VALUE,u=Number.MIN_VALUE,h=[];for(let t=0;t<e.x.length;t++){let n=e.x[t],r=e.y[t];c>n&&(c=n),f<n&&(f=n),p>r&&(p=r),u<r&&(u=r),h.push("".concat(n," ").concat(r))}let m="##TITLE=".concat(n,"\n##JCAMP-DX=4.24\n##DATA TYPE=").concat(a,"\n##ORIGIN=").concat(i,"\n##OWNER=").concat(r,"\n##XUNITS=").concat(l,"\n##YUNITS=").concat(o,"\n##FIRSTX=").concat(c,"\n##LASTX=").concat(f,"\n##FIRSTY=").concat(p,"\n##LASTY=").concat(u,"\n");for(const e of Object.keys(s))m+="##$".concat(e,"=").concat(s[e],"\n");return"".concat(m,"##NPOINTS=").concat(h.length,"\n##PEAK TABLE=(XY..XY)\n").concat(h.join("\n"),"\n##END")}var f=Object.freeze({__proto__:null,fromText:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{meta:n={},parserOptions:r={}}=t;r.keepInfo=!0;let a=i(e,r);return n.info||(n.info={}),n.info.header=a.info.map(e=>e.value).join("\n"),c(a.data,n)},fromJSON:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(s(e,{outputFormat:"xxyyObject"}),t)}});function p(){const e=/[, \t]+/,t=["TIC",".RIC","SCANNUMBER"];function n(e){let t=[];for(let n=0;n<e.length;n++)t.push(parseFloat(e[n]));return t}class r{}const i={keepRecordsRegExp:/^$/,canonicDataLabels:!0,dynamicTyping:!1,xy:!1,withoutXY:!1,chromatogram:!1,keepSpectra:!1,noContour:!1,nbContourLevels:7,noiseMultiplier:5,profiling:!1};function a(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"")}function l(e){return-1!==t.indexOf(e)}function o(e,t){if(t.xFactor||(t.xFactor=1),t.yFactor||(t.yFactor=1),t.observeFrequency&&t.xUnit&&"HZ"===t.xUnit.toUpperCase()&&(t.xUnit="PPM",t.xFactor=t.xFactor/t.observeFrequency,t.firstX=t.firstX/t.observeFrequency,t.lastX=t.lastX/t.observeFrequency,t.deltaX=t.deltaX/t.observeFrequency),t.shiftOffsetVal){let e=t.firstX-t.shiftOffsetVal;t.firstX=t.firstX-e,t.lastX=t.lastX-e}}function s(e){let t=(e=e.sort(c)).length;return e[Math.floor(t/2)]}function c(e,t){return e-t}function f(e,t){let n=e.yFactor,r=e.deltaX;e.isXYdata=!0;let i=[];e.data=[i];let a,l=e.firstX,o=e.firstY,s=!1,c=0;for(;c<t.length;c++)if(a=t.charCodeAt(c),13===a||10===a)s=!0;else if(s)break;let f=!0,p=!1,u=!1,h=0,m=!1,y=!1,g=0,d=0,x=!1,b=!1,A=!1,O=0;for(;c<=t.length;c++)if(a=c===t.length?13:t.charCodeAt(c),y)13!==a&&10!==a||(f=!0,y=!1);else if(a<=57&&a>=48)b=!0,O>0?g+=(a-48)/Math.pow(10,O++):(g*=10,g+=a-48);else if(44===a||46===a)b=!0,O++;else{if(b){if(f)f=!1,u&&(A=!0);else if(A)A=!1;else{p?(h=x?0-g:g,u=!0,p=!1):m||(d=x?0-g:g);let e=m?g-1:1;for(let t=0;t<e;t++)u?o+=h:o=d,i.push(l),i.push(o*n),l+=r}x=!1,g=0,O=0,b=!1,m=!1}if(a<74&&a>63)b=!0,u=!1,g=a-64;else if(a>96&&a<106)b=!0,u=!1,g=a-96,x=!0;else if(115===a)b=!0,m=!0,g=9;else if(a>82&&a<91)b=!0,m=!0,g=a-82;else if(a>73&&a<83)b=!0,p=!0,g=a-73;else if(a>105&&a<115)b=!0,p=!0,g=a-105,x=!0;else if(36===a&&36===t.charCodeAt(c+1))b=!0,y=!0;else if(37===a)b=!0,p=!0,g=0,x=!1;else if(45===a){let e=t.charCodeAt(c+1);(e>=48&&e<=57||44===e||46===e)&&(b=!0,f||(u=!1),x=!0)}else 13!==a&&10!==a||(f=!0,y=!1)}}function p(e,t){let n,r=/(\(+|\)+|<+|>+|\s+)/g;e.isXYAdata=!0;let i=[];e.data=[i];let a=t.split(/,? *,?[;\r\n]+ */);for(let e=1;e<a.length;e++)n=a[e].trim().replace(r,"").split(","),i.push(parseFloat(n[0])),i.push(parseFloat(n[1]))}function u(e,t,n){let r,i=/\$\$.*/,a=/[,\t ]+/;e.isPeaktable=!0;let l=[];e.data=[l];let o=t.split(/,? *,?[;\r\n]+ */);for(let t=1;t<o.length;t++)if(r=o[t].trim().replace(i,"").split(a),r.length%2==0)for(let t=0;t<r.length;t+=2)l.push(parseFloat(r[t])*e.xFactor),l.push(parseFloat(r[t+1])*e.yFactor);else n.logs.push("Format error: ".concat(r))}return function(c,h){let m,y,g,d,x,b,A=!(h=Object.assign({},i,h)).withoutXY,O=Date.now(),X={},F={};F.profiling=!!h.profiling&&[],F.logs=[];let E=[];F.spectra=E,F.info={};let T=new r;if("string"!=typeof c)throw new TypeError("the JCAMP should be a string");F.profiling&&F.profiling.push({action:"Before split to LDRS",time:Date.now()-O}),g=c.split(/[\r\n]+##/),F.profiling&&F.profiling.push({action:"Split to LDRS",time:Date.now()-O}),g[0]&&(g[0]=g[0].replace(/^[\r\n ]*##/,""));for(let t=0;t<g.length;t++){let i;m=g[t],d=m.indexOf("="),d>0?(i=m.substring(0,d),y=m.substring(d+1).trim()):(i=m,y="");let s=i.replace(/[_ -]/g,"").toUpperCase();if("DATATABLE"===s&&(x=y.indexOf("\n"),-1===x&&(x=y.indexOf("\r")),x>0)){let e=-1,t=-1;if(b=y.substring(0,x).split(/[ ,;\t]+/),b[0].indexOf("++")>0){let n=b[0].replace(/.*\(([a-zA-Z0-9]+)\+\+.*/,"$1"),r=b[0].replace(/.*\.\.([a-zA-Z0-9]+).*/,"$1");e=X.symbol.indexOf(n),t=X.symbol.indexOf(r)}-1===e&&(e=0),-1===t&&(t=0),X.first&&(X.first.length>e&&(T.firstX=X.first[e]),X.first.length>t&&(T.firstY=X.first[t])),X.last&&(X.last.length>e&&(T.lastX=X.last[e]),X.last.length>t&&(T.lastY=X.last[t])),X.vardim&&X.vardim.length>e&&(T.nbPoints=X.vardim[e]),X.factor&&(X.factor.length>e&&(T.xFactor=X.factor[e]),X.factor.length>t&&(T.yFactor=X.factor[t])),X.units&&(X.units.length>e&&(T.xUnit=X.units[e]),X.units.length>t&&(T.yUnit=X.units[t])),T.datatable=b[0],b[1]&&b[1].indexOf("PEAKS")>-1?s="PEAKTABLE":b[1]&&(b[1].indexOf("XYDATA")||b[0].indexOf("++")>0)&&(s="XYDATA",T.deltaX=(T.lastX-T.firstX)/(T.nbPoints-1))}if("XYDATA"!==s)if("PEAKTABLE"!==s)if("PEAKASSIGNMENTS"!==s){if("TITLE"===s)T.title=y;else if("DATATYPE"===s)T.dataType=y,y.indexOf("nD")>-1&&(F.twoD=!0);else if("NTUPLES"===s)y.indexOf("nD")>-1&&(F.twoD=!0);else if("XUNITS"===s)T.xUnit=y;else if("YUNITS"===s)T.yUnit=y;else if("FIRSTX"===s)T.firstX=parseFloat(y);else if("LASTX"===s)T.lastX=parseFloat(y);else if("FIRSTY"===s)T.firstY=parseFloat(y);else if("LASTY"===s)T.lastY=parseFloat(y);else if("NPOINTS"===s)T.nbPoints=parseFloat(y);else if("XFACTOR"===s)T.xFactor=parseFloat(y);else if("YFACTOR"===s)T.yFactor=parseFloat(y);else if("MAXX"===s)T.maxX=parseFloat(y);else if("MINX"===s)T.minX=parseFloat(y);else if("MAXY"===s)T.maxY=parseFloat(y);else if("MINY"===s)T.minY=parseFloat(y);else if("DELTAX"===s)T.deltaX=parseFloat(y);else if(".OBSERVEFREQUENCY"===s||"$SFO1"===s)T.observeFrequency||(T.observeFrequency=parseFloat(y));else if(".OBSERVENUCLEUS"===s)T.xType||(F.xType=y.replace(/[^a-zA-Z0-9]/g,""));else if("$SFO2"===s)F.indirectFrequency||(F.indirectFrequency=parseFloat(y));else if("$OFFSET"===s)F.shiftOffsetNum=0,T.shiftOffsetVal||(T.shiftOffsetVal=parseFloat(y));else if("$REFERENCEPOINT"===s);else if("VARNAME"===s)X.varname=y.split(e);else if("SYMBOL"===s)X.symbol=y.split(e);else if("VARTYPE"===s)X.vartype=y.split(e);else if("VARFORM"===s)X.varform=y.split(e);else if("VARDIM"===s)X.vardim=n(y.split(e));else if("UNITS"===s)X.units=y.split(e);else if("FACTOR"===s)X.factor=n(y.split(e));else if("FIRST"===s)X.first=n(y.split(e));else if("LAST"===s)X.last=n(y.split(e));else if("MIN"===s)X.min=n(y.split(e));else if("MAX"===s)X.max=n(y.split(e));else if(".NUCLEUS"===s)F.twoD&&(F.yType=y.split(e)[0]);else if("PAGE"===s){T.page=y.trim(),T.pageValue=parseFloat(y.replace(/^.*=/,"")),T.pageSymbol=T.page.replace(/[=].*/,"");let e=X.symbol.indexOf(T.pageSymbol),t="";X.units&&X.units[e]&&(t=X.units[e]),F.indirectFrequency&&"PPM"!==t&&(T.pageValue/=F.indirectFrequency)}else"RETENTIONTIME"===s?T.pageValue=parseFloat(y):l(s)?T[a(s)]=y:"SAMPLEDESCRIPTION"===s&&(T.sampleDescription=y);if(s.match(h.keepRecordsRegExp)){let e=h.canonicDataLabels?s:i,t=y.trim();h.dynamicTyping&&!isNaN(t)&&(t=Number(t)),F.info[e]?(Array.isArray(F.info[e])||(F.info[e]=[F.info[e]]),F.info[e].push(t)):F.info[e]=t}}else A&&(y.match(/.*(XYA).*/)&&p(T,y),E.push(T),T=new r);else A&&(o(F,T),u(T,y,F),E.push(T),T=new r);else A&&(o(F,T),y.match(/.*\+\+.*/)?(T.deltaX||(T.deltaX=(T.lastX-T.firstX)/(T.nbPoints-1)),f(T,y)):u(T,y,F),E.push(T),T=new r)}if(F.profiling&&F.profiling.push({action:"Finished parsing",time:Date.now()-O}),Object.keys(X).length>0){let e=[],t=Object.keys(X);for(let n=0;n<t.length;n++){let r=t[n],i=X[r];for(let t=0;t<i.length;t++)e[t]||(e[t]={}),e[t][r]=i[t]}F.ntuples=e}if(F.twoD&&A&&(!function(e,t){let n=function(e){let t=e[0].data[0][0],n=t,r=e.length,i=e[0].data[0].length/2,a=new Array(r);for(let l=0;l<r;l++){a[l]=new Array(i);let r=e[l].data[0];for(let e=0;e<i;e++){let i=r[2*e+1];a[l][e]=i,i<t&&(t=i),i>n&&(n=i)}}const l=e[0].data[0][0],o=e[0].data[0][e[0].data[0].length-2],c=e[0].pageValue,f=e[r-1].pageValue;if(l>o)for(let e of a)e.reverse();c>f&&a.reverse();return{z:a,minX:Math.min(l,o),maxX:Math.max(l,o),minY:Math.min(c,f),maxY:Math.max(c,f),minZ:t,maxZ:n,noise:s(a[0].map(Math.abs))}}(e.spectra);t.noContour||(e.contourLines=function(e,t){let n,r,i,a,l,o,s,c,f,p,u,h,m,y=e.noise,g=e.z,d=g.length,x=g[0].length,b=e.minX,A=(e.maxX-b)/(x-1),O=e.minY,X=(e.maxY-O)/(d-1),F=e.minZ,E=e.maxZ,T=2*t.nbContourLevels,v=new Array(T);for(let e=0;e<T;e++){let T={};v[e]=T;let w=e%2,N=(E-t.noiseMultiplier*y)*Math.exp((e>>1)-t.nbContourLevels);m=0===w?N+t.noiseMultiplier*y:0-N-t.noiseMultiplier*y;let S=[];if(T.zValue=m,T.lines=S,!(m<=F||m>=E))for(let e=0;e<d-1;e++){let t=g[e],y=g[e+1];for(let g=0;g<x-1;g++)n=t[g],r=t[g+1],i=y[g],a=y[g+1],l=n>m,o=r>m,s=i>m,c=a>m,l!==o&&l!==s&&(f=g+(m-n)/(r-n),p=e,u=g,h=e+(m-n)/(i-n),S.push(f*A+b),S.push(p*X+O),S.push(u*A+b),S.push(h*X+O)),c!==o&&c!==s&&(f=g+1,p=e+1-(m-a)/(r-a),u=g+1-(m-a)/(i-a),h=e+1,S.push(f*A+b),S.push(p*X+O),S.push(u*A+b),S.push(h*X+O)),o!==s&&(f=(g+1-(m-r)/(i-r))*A+b,p=(e+(m-r)/(i-r))*X+O,o!==l&&(u=g+1-(m-r)/(n-r),h=e,S.push(f),S.push(p),S.push(u*A+b),S.push(h*X+O)),s!==l&&(u=g,h=e+1-(m-i)/(n-i),S.push(f),S.push(p),S.push(u*A+b),S.push(h*X+O)),o!==c&&(u=g+1,h=e+(m-r)/(a-r),S.push(f),S.push(p),S.push(u*A+b),S.push(h*X+O)),s!==c&&(u=g+(m-i)/(a-i),h=e+1,S.push(f),S.push(p),S.push(u*A+b),S.push(h*X+O)))}}return{minX:e.minX,maxX:e.maxX,minY:e.minY,maxY:e.maxY,segments:v}}(n,t),delete n.z);e.minMax=n}(F,h),F.profiling&&F.profiling.push({action:"Finished countour plot calculation",time:Date.now()-O}),h.keepSpectra||delete F.spectra),h.chromatogram&&(h.xy=!0),h.xy&&A&&E.length>0)for(let e=0;e<E.length;e++)if(T=E[e],T.data.length>0)for(let e=0;e<T.data.length;e++){let t=T.data[e],n={x:new Array(t.length/2),y:new Array(t.length/2)};for(let e=0;e<t.length;e+=2)n.x[e/2]=t[e],n.y[e/2]=t[e+1];T.data[e]=n}return h.chromatogram&&(F.spectra.length>1?function(e){let n=e.spectra,r=n.length,i={times:new Array(r),series:{ms:{dimension:2,data:new Array(r)}}},l=[];for(let e=0;e<t.length;e++){let o=a(t[e]);n[0][o]&&(l.push(o),i.series[o]={dimension:1,data:new Array(r)})}for(let e=0;e<r;e++){let t=n[e];i.times[e]=t.pageValue;for(let n=0;n<l.length;n++)i.series[l[n]].data[e]=parseFloat(t[l[n]]);t.data&&(i.series.ms.data[e]=[t.data[0].x,t.data[0].y])}e.chromatogram=i}(F):function(e){let t=e.spectra[0].data[0];e.chromatogram={times:t.x.slice(),series:{intensity:{dimension:1,data:t.y.slice()}}}}(F),F.profiling&&F.profiling.push({action:"Finished chromatogram calculation",time:Date.now()-O})),F.profiling&&F.profiling.push({action:"Total time",time:Date.now()-O}),F}}let u=p();let h,m={};var y,g,d={convert:function(e,t,n){return"boolean"==typeof t&&(n=t,t={}),n?function(e,t){h||function(){let e=URL.createObjectURL(new Blob(["var getConverter =".concat(p.toString(),";var convert = getConverter(); onmessage = function (event) { var data = JSON.parse(event.data); postMessage(JSON.stringify({stamp: data.stamp, output: convert(data.input, data.options)})); };")],{type:"application/javascript"}));h=new Worker(e),URL.revokeObjectURL(e),h.addEventListener("message",(function(e){let t=JSON.parse(e.data),n=t.stamp;m[n]&&m[n](t.output)}))}();return new Promise((function(n){let r="".concat(Date.now()).concat(Math.random());m[r]=n,h.postMessage(JSON.stringify({stamp:r,input:e,options:t}))}))}(e,t):u(e,t)},createTree:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{flatten:n=!1}=t;if("string"!=typeof e)throw new TypeError("the JCAMP should be a string");let r,i=e.split(/[\r\n]+/),a=[],l=[],o=[],s=0,c=e.includes("## ");for(let e=0;e<i.length;e++){let t=i[e],n=c?t.replace(/ /g,""):t;if("##NTUPLES"===n.substring(0,9)&&s++,"##TITLE"===n.substring(0,7)){let o=[n.substring(8).trim()];for(let t=e+1;t<i.length&&!i[t].startsWith("##");t++)o.push(i[t].trim());l.push({title:o.join("\n"),jcamp:"".concat(t,"\n"),children:[]}),r=l[l.length-1],a.push(r)}else if("##END"===n.substring(0,5)&&0===s){r.jcamp+="".concat(t,"\n");let e=l.pop();0!==l.length?(r=l[l.length-1],r.children.push(e)):(r=void 0,o.push(e))}else if(r&&r.jcamp){r.jcamp+="".concat(t,"\n");let e=n.match(/^##(.*?)=(.+)/);if(e){"DATATYPE"===e[1].replace(/[ _-]/g,"").toUpperCase()&&(r.dataType=e[2].trim())}}"##END"===n.substring(0,5)&&s>0&&s--}return n?(a.forEach(e=>{e.children=void 0}),a):o}},x=(y=f)&&y.default||y,b=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{meta:i={}}=r;e&&e.length>1&&e[0]>e[1]?(this.x=e.reverse(),this.y=t.reverse()):(this.x=e||[],this.y=t||[]),this.id=n,this.meta=i}getXLabel(){return"Voltage [V]"}getYLabel(){return"Intensity [A]"}}function i(e,t){let n={},r=(e=e.replace(/ ([xy]) /g,",$1,")).split("; ");for(let e of r){let r=a(e,t);n[r.axis]=r}return n}function a(e,t){let n=e.split(","),r={};if(r.axis=n[1],r.kind=n[0],r.unit=n[4].replace(/"/g,""),"SetScale/P"===r.kind){let e=Number(n[2]),i=Number(n[3]),a=[];for(let n=0;n<t;n++)a.push(e),e+=i,r.values=a}return r}function l(e){return{CE:"counterElectrodeType",Calibrationfile:"calibrationFile",Username:"username",WE:"workingElectrodeGlass",cellname:"cellname",electrolyte:"electrolyteZ960",layer:"semicondutorLayer",specification:"remarks",temp:"workingTemperature",type:"typeOfCell",AR:"cellActiveArea",IT:"powerIn"}[e]||e}n.prototype.getData=function(){return{x:this.x,y:this.y}},n.prototype.toJcamp=function(){return function(e){let t={owner:"",origin:"",type:"IV curve",xUnit:"difference in electric potential [V]",yUnit:"intensity [A]",info:e.meta};return x.fromJSON({x:e.x,y:e.y},t)}(this)},t.Spectrum=n,t.fromJcamp=function(e,t){const r=d.convert(e,{xy:!0,keepRecordsRegExp:/.*/,canonicDataLabels:!1,dynamicTyping:!0});let i=r.spectra[0].data[0],a=r.info,l={};for(let e of Object.keys(a).filter(e=>e.startsWith("$")))l[e.substr(1)]=a[e];return new n(i.x,i.y,t,{meta:l})},t.fromSIV=function(e){let t=e.split(/[\r\n]+/),a=function(e){let t={};for(let n of e){let e=n.replace(/X ._([^=]*)=(.*)/,"$1").trim();e=l(e);let r=n.replace(/X ._([^=]*)=(.*)/,"$2").trim();r=r.replace(/^"(.*)"$/,"$1"),isNaN(r)||(r=Number(r)),t[e]=r}return t}(t.filter(e=>e.match(/X S_/))),o=function(e){let t={};for(let n of e){let e=n.replace(/X ._([^=]*)=(.*)/,"$1").trim();e=l(e);let r=n.replace(/X ._([^=]*)=(.*)/,"$2").trim();r=r.replace(/^"(.*)"$/,"$1"),isNaN(r)||(r=Number(r)),t[e]=r}return t}(t.filter(e=>e.match(/X V_/))),s=function(e){let t=e.replace("X d_t=","").trim().replace(/"/g,"");return new Date(t)}(t.filter(e=>e.match(/X d_t/))[0]),c=e.split("WAVES\t"),f=[];for(let e of c){let t=e.split(/[\r\n]+/),l=t.filter(e=>e.match(/^[\t 0-9.eE-]+$/)).map(e=>Number(e));if(l.length<10)continue;let c=t[0].trim(),p=i(t.filter(e=>e.match(/^X /)).map(e=>e.substring(2))[0],l.length);if(void 0===p.x||"V"!==p.x.unit){console.log("Unknown X axis:",p.kind,p.unit);continue}if(void 0===p.y||"A"!==p.y.unit){console.log("Unknown Y axis:",p.kind,p.unit);continue}let u={x:p.x.values,y:l},h=r({},a,{date:s,experiment:c},o);f.push(new n(u.x,u.y,f.length+1,{meta:h}))}return f}})),A=(g=b)&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,O=b.Spectrum,X=b.fromJcamp,F=b.fromSIV;e.Spectrum=O,e.default=A,e.fromJcamp=X,e.fromSIV=F,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=iv-spectrum.min.js.map
